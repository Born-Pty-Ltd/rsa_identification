import 'dart:convert';
import 'dart:typed_data';

import 'package:rsa_identification/rsa_identification.dart';
import 'package:test/test.dart';

void main() {
  group('SmartId', () {
    test('fromBytes instantiates object accurately when passing valid bytes',
        () {
      Uint8List validBytes = utf8.encode(
          'SURNAME|NAME|GENDER|NATIONALITY|ID NUMBER|29 Jul 2000|COUNTRY OF BIRTH|CITIZENSHIP STATUS|26 Jan 2017|23370|SMART ID NUMBER|1234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890');
      var smartId = SmartId.fromBytes(validBytes);

      expect(smartId.surname, 'SURNAME');
      expect(smartId.firstNames, 'NAME');
      expect(smartId.gender, 'GENDER');
      expect(smartId.nationality, 'NATIONALITY');
      expect(smartId.idNumber, 'ID NUMBER');
      expect(smartId.birthDate, DateTime(2000, 7, 29));
      expect(smartId.countryOfBirth, 'COUNTRY OF BIRTH');
      expect(smartId.citizenshipStatus, 'CITIZENSHIP STATUS');
      expect(smartId.issueDate, DateTime(2017, 1, 26));
      expect(smartId.smartIdNumber, 'SMART ID NUMBER');
    });

    test('fromBytes throws FormatException when passing invalid bytes', () {
      Uint8List invalidBytes = utf8.encode(
          'SURNAME|NAME|GENDER|NATIONALITY|29 Jul 2000|COUNTRY OF BIRTH|CITIZENSHIP STATUS|26 Jan 2017|23370|SMART ID NUMBER|1234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890');
      try {
        SmartId.fromBytes(invalidBytes);
      } catch (e) {
        expect(e, isFormatException);
      }
    });
  });

  group('SmartId', () {
    test('fromBytes instantiates object accurately when passing valid bytes',
        () {
      List list = [
        '02',
        '6d',
        '16',
        '03',
        '00',
        '32',
        '01',
        '16',
        '82',
        '5a',
        '42',
        'e1',
        'e1',
        'e1',
        '53',
        '41',
        '4e',
        '44',
        '45',
        '52',
        '53',
        'e0',
        '4a',
        'e1',
        '5a',
        '41',
        'e0',
        '5a',
        '41',
        'e0',
        '30',
        'e1',
        'e1',
        'e1',
        '36',
        '32',
        '33',
        '34',
        '35',
        '36',
        '30',
        '30',
        '30',
        '31',
        '41',
        '42',
        'e0',
        '38',
        '36',
        '30',
        '39',
        '31',
        '33',
        '35',
        '31',
        '33',
        '39',
        '30',
        '31',
        '32',
        '02',
        '20',
        '07',
        '02',
        '19',
        'aa',
        'a1',
        '0a',
        '01',
        '19',
        '86',
        '09',
        '13',
        '20',
        '12',
        '11',
        '14',
        '20',
        '17',
        '12',
        '14',
        '01',
        '57',
        '49',
        '04',
        '00',
        'fa',
        '00',
        'c8',
        '43',
        '2e',
        '28',
        '40',
        '00',
        '28',
        '42',
        '34',
        '55',
        'a7',
        '42',
        'bc',
        'e8',
        'd2',
        '30',
        'e7',
        '35',
        'e5',
        '5d',
        'db',
        'df',
        '3b',
        '3b',
        'd3',
        '4c',
        'f6',
        'fe',
        '39',
        'ce',
        '41',
        'e6',
        'fe',
        '59',
        '7b',
        '22',
        'f6',
        'f9',
        '70',
        '14',
        '31',
        'ee',
        'f7',
        'eb',
        '16',
        'bd',
        'de',
        'f7',
        'be',
        '7f',
        '9b',
        'de',
        'e8',
        '7f',
        'f1',
        'c3',
        '40',
        'a1',
        '82',
        '87',
        'f2',
        'd1',
        '8b',
        '1c',
        '2d',
        'f0',
        'ea',
        '84',
        'e4',
        'a8',
        '58',
        '5e',
        '83',
        '43',
        '9a',
        '85',
        '4f',
        '0d',
        '02',
        '85',
        '59',
        'd6',
        'cc',
        '21',
        '7b',
        '54',
        'a3',
        'cf',
        'b8',
        'd3',
        '39',
        '65',
        'd1',
        '19',
        'a9',
        '4a',
        '12',
        '70',
        'ef',
        'ce',
        '58',
        'b3',
        'f9',
        '6e',
        '0d',
        'a8',
        'd0',
        'd6',
        '04',
        '51',
        '92',
        'c1',
        '24',
        'af',
        'b1',
        '63',
        '88',
        'a1',
        'd1',
        '30',
        'ee',
        '30',
        'a7',
        '21',
        '41',
        '18',
        'c2',
        '5f',
        '6a',
        '08',
        '7b',
        '8a',
        'e3',
        '71',
        '1c',
        'e1',
        '0c',
        '24',
        '5a',
        'c6',
        '38',
        '1a',
        '51',
        '83',
        '95',
        '04',
        '4c',
        '7a',
        'c3',
        '4f',
        '1d',
        '26',
        'c7',
        'd4',
        '66',
        '5a',
        'e1',
        'd0',
        '8c',
        '50',
        '3e',
        '35',
        'a6',
        'bb',
        '69',
        'ba',
        'ba',
        'e3',
        '3d',
        '2a',
        '2f',
        '90',
        '77',
        '92',
        'd4',
        '79',
        'a0',
        '5b',
        '8d',
        'e2',
        'bb',
        '56',
        '5e',
        '86',
        '5e',
        'aa',
        '5e',
        '8c',
        '88',
        'fb',
        '61',
        '6c',
        '86',
        '3e',
        'bc',
        '61',
        '14',
        '37',
        '99',
        '8f',
        '73',
        '36',
        '82',
        '86',
        '6d',
        '14',
        'bc',
        '6c',
        '30',
        '91',
        '07',
        '24',
        '88',
        '20',
        '4f',
        'f8',
        'b4',
        '80',
        '01',
        '57',
        'b1',
        '11',
        'c1',
        '20',
        '00',
        'ac',
        'b0',
        '5b',
        '81',
        '7e',
        'eb',
        '63',
        'e1',
        '92',
        'c4',
        '1e',
        '1b',
        'a6',
        '71',
        'ff',
        '47',
        'c2',
        '8d',
        '24',
        '14',
        '05',
        '60',
        'f8',
        '7c',
        '4c',
        '15',
        'c1',
        '29',
        'f3',
        'e4',
        '04',
        '58',
        '24',
        '05',
        '62',
        '99',
        'cb',
        '0e',
        '11',
        '12',
        'b6',
        '12',
        '44',
        '34',
        '91',
        '76',
        '12',
        'a9',
        '1d',
        '8d',
        '19',
        '2c',
        '59',
        'f4',
        '96',
        '35',
        '00',
        '36',
        'fc',
        '63',
        '66',
        '82',
        'd6',
        '14',
        '0f',
        '87',
        'f1',
        '7f',
        '35',
        '7a',
        'be',
        '8f',
        'f2',
        '15',
        '57',
        '7a',
        'da',
        'b6',
        '42',
        '1a',
        'd4',
        '44',
        'c0',
        '68',
        'fb',
        'bd',
        'd7',
        'f1',
        '61',
        '32',
        '09',
        '75',
        '31',
        'd5',
        '16',
        'a7',
        '9c',
        'a7',
        'f1',
        '45',
        '55',
        '9b',
        'ec',
        '05',
        '89',
        '65',
        'b5',
        '20',
        '2f',
        'd4',
        'b2',
        'f9',
        '14',
        '3a',
        '42',
        '87',
        '85',
        '26',
        '02',
        '68',
        'ca',
        'ad',
        'e6',
        '5a',
        '00',
        '39',
        '71',
        'aa',
        'ba',
        '65',
        '97',
        'c2',
        'da',
        '0e',
        '2b',
        '84',
        '1c',
        'a8',
        '76',
        'e8',
        '8f',
        'c4',
        '70',
        '02',
        'a6',
        'ad',
        '10',
        'f1',
        '6b',
        '38',
        '60',
        'ee',
        'f4',
        '28',
        '63',
        '44',
        '8f',
        '47',
        'a6',
        '33',
        'e9',
        '82',
        'f4',
        'ec',
        '07',
        '75',
        '46',
        '02',
        '98',
        'fc',
        '43',
        'c4',
        '57',
        '44',
        'f0',
        'bc',
        'ce',
        '2d',
        '3d',
        'ee',
        '64',
        '81',
        '56',
        'a8',
        '4d',
        '70',
        '67',
        '0e',
        'da',
        'f4',
        '93',
        '2a',
        '38',
        'c8',
        '3c',
        '2e',
        '72',
        '1b',
        'e2',
        '12',
        '47',
        '0b',
        'c5',
        '04',
        '19',
        'c4',
        '5b',
        'db',
        '5a',
        'ac',
        '04',
        '77',
        '95',
        '9f',
        '7c',
        '20',
        '03',
        '08',
        '42',
        '0b',
        'b4',
        '55',
        '34',
        '5c',
        '6b',
        '89',
        '6c',
        'a9',
        'e2',
        '01',
        'f3',
        '18',
        'd7',
        '5e',
        'ec',
        '35',
        '97',
        '6e',
        '1b',
        '44',
        '38',
        '8f',
        '62',
        '2e',
        '49',
        '13',
        '00',
        '25',
        '58',
        'ed',
        '3d',
        '08',
        'ff',
        '86',
        'fb',
        'a8',
        'd8',
        '76',
        '05',
        '4b',
        '05',
        '8b',
        '24',
        '09',
        '61',
        'ae',
        '90',
        '50',
        'd7',
        'da',
        '0d',
        '8d',
        '2c',
        '11',
        'a3',
        'bd',
        '80',
        '78',
        'ee',
        'b0',
        'ae',
        '70',
        '9f',
        '18',
        '86',
        '08',
        'dd',
        '8a',
        '4d',
        '44',
        '02',
        '03',
        '62',
        '28',
        '53',
        '77',
        '28',
        '20',
        '92',
        'ea',
        'a0',
        'a2',
        'c4',
        '13',
        '24',
        '06',
        'aa',
        'db',
        '77',
        '41',
        '67',
        '3d',
        '69',
        'd7',
        'dd',
        'e6',
        '05',
        '8c',
        'e5',
        'aa',
        '2d',
        'b5',
        '68',
        '10',
        '05',
        '00',
        '44',
        '5a',
        '45',
        'd5',
        '14',
        '45',
        '10',
        '14',
        '59',
        '4b',
        '86',
        '20',
        'a2',
        'aa',
        '20',
        '00',
        '16',
        '3b',
        '50',
        '01',
        '00',
        '14',
        '50',
        '05',
        '55',
        '55',
        '01',
        '04',
        '45',
        '40',
        '55',
        '54',
        '10',
        '00',
        '00',
        '00',
        '00',
        '00',
        '00',
        '00',
        '00',
        '00',
        '00',
        '00',
        '00'
      ].map((hex) => int.parse(hex, radix: 16)).toList();
      var validBytes = Uint8List.fromList(list);
      var driversLicense = DriversLicense.fromBytes(validBytes);

      expect(driversLicense.surname, 'SANDERS');
    });
  });
}
